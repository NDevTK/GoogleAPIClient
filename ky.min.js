/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/ky@1.14.3/distribution/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
class t extends Error{response;request;options;constructor(t,e,o){const s=`${t.status||0===t.status?t.status:""} ${t.statusText??""}`.trim();super(`Request failed with ${s?`status code ${s}`:"an unknown error"}: ${e.method} ${e.url}`),this.name="HTTPError",this.response=t,this.request=e,this.options=o}}class e extends Error{name="NonError";value;constructor(t){let e="Non-error value was thrown";try{"string"==typeof t?e=t:t&&"object"==typeof t&&"message"in t&&"string"==typeof t.message&&(e=t.message)}catch{}super(e),this.value=t}}class o extends Error{name="ForceRetryError";customDelay;code;customRequest;constructor(t){const o=t?.cause?t.cause instanceof Error?t.cause:new e(t.cause):void 0;super(t?.code?`Forced retry: ${t.code}`:"Forced retry",o?{cause:o}:void 0),this.customDelay=t?.delay,this.code=t?.code,this.customRequest=t?.request}}const s=(()=>{let t=!1,e=!1;const o="function"==typeof globalThis.ReadableStream,s="function"==typeof globalThis.Request;if(o&&s)try{e=new globalThis.Request("https://empty.invalid",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type")}catch(t){if(t instanceof Error&&"unsupported BodyInit type"===t.message)return!1;throw t}return t&&!e})(),r="function"==typeof globalThis.AbortController,n="function"==typeof globalThis.AbortSignal&&"function"==typeof globalThis.AbortSignal.any,i="function"==typeof globalThis.ReadableStream,a="function"==typeof globalThis.FormData,h=["get","post","put","patch","head","delete"],c={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*",bytes:"*/*"},u=2147483647,l=(new TextEncoder).encode("------WebKitFormBoundaryaxpyiPgbbPti10Rw").length,p=Symbol("stop");class f{options;constructor(t){this.options=t}}const d=t=>new f(t),y={json:!0,parseJson:!0,stringifyJson:!0,searchParams:!0,prefixUrl:!0,retry:!0,timeout:!0,hooks:!0,throwHttpErrors:!0,onDownloadProgress:!0,onUploadProgress:!0,fetch:!0,context:!0},g={next:!0},m={method:!0,headers:!0,body:!0,mode:!0,credentials:!0,cache:!0,redirect:!0,referrer:!0,referrerPolicy:!0,integrity:!0,keepalive:!0,signal:!0,window:!0,duplex:!0},b=(t,e,o)=>{let s,r=0;return t.pipeThrough(new TransformStream({transform(t,n){if(n.enqueue(t),s){r+=s.byteLength;let t=0===e?0:r/e;t>=1&&(t=1-Number.EPSILON),o?.({percent:t,totalBytes:Math.max(e,r),transferredBytes:r},s)}s=t},flush(){s&&(r+=s.byteLength,o?.({percent:1,totalBytes:Math.max(e,r),transferredBytes:r},s))}}))},w=(t,e,o)=>{if(!t.body)return t;const s=(t=>{if(!t)return 0;if(t instanceof FormData){let e=0;for(const[o,s]of t)e+=l,e+=(new TextEncoder).encode(`Content-Disposition: form-data; name="${o}"`).length,e+="string"==typeof s?(new TextEncoder).encode(s).length:s.size;return e}if(t instanceof Blob)return t.size;if(t instanceof ArrayBuffer)return t.byteLength;if("string"==typeof t)return(new TextEncoder).encode(t).length;if(t instanceof URLSearchParams)return(new TextEncoder).encode(t.toString()).length;if("byteLength"in t)return t.byteLength;if("object"==typeof t&&null!==t)try{const e=JSON.stringify(t);return(new TextEncoder).encode(e).length}catch{return 0}return 0})(o??t.body);return new Request(t,{duplex:"half",body:b(t.body,s,e)})},R=t=>null!==t&&"object"==typeof t,T=(...t)=>{for(const e of t)if((!R(e)||Array.isArray(e))&&void 0!==e)throw new TypeError("The `options` argument must be an object");return S({},...t)},q=(t={},e={})=>{const o=new globalThis.Headers(t),s=e instanceof globalThis.Headers,r=new globalThis.Headers(e);for(const[t,e]of r.entries())s&&"undefined"===e||void 0===e?o.delete(t):o.set(t,e);return o};function P(t,e,o){return Object.hasOwn(e,o)&&void 0===e[o]?[]:S(t[o]??[],e[o]??[])}const x=(t={},e={})=>({beforeRequest:P(t,e,"beforeRequest"),beforeRetry:P(t,e,"beforeRetry"),afterResponse:P(t,e,"afterResponse"),beforeError:P(t,e,"beforeError")}),E=(t,e)=>{const o=new URLSearchParams;for(const s of[t,e])if(void 0!==s)if(s instanceof URLSearchParams)for(const[t,e]of s.entries())o.append(t,e);else if(Array.isArray(s))for(const t of s){if(!Array.isArray(t)||2!==t.length)throw new TypeError("Array search parameters must be provided in [[key, value], ...] format");o.append(String(t[0]),String(t[1]))}else if(R(s))for(const[t,e]of Object.entries(s))void 0!==e&&o.append(t,String(e));else{const t=new URLSearchParams(s);for(const[e,s]of t.entries())o.append(e,s)}return o},S=(...t)=>{let e,o={},s={},r={};const i=[];for(const n of t)if(Array.isArray(n))Array.isArray(o)||(o=[]),o=[...o,...n];else if(R(n)){for(let[t,s]of Object.entries(n))if("signal"===t&&s instanceof globalThis.AbortSignal)i.push(s);else if("context"!==t)"searchParams"!==t?(R(s)&&t in o&&(s=S(o[t],s)),o={...o,[t]:s}):e=null==s?void 0:void 0===e?s:E(e,s);else{if(null!=s&&(!R(s)||Array.isArray(s)))throw new TypeError("The `context` option must be an object");o={...o,context:null==s?{}:{...o.context,...s}}}R(n.hooks)&&(r=x(r,n.hooks),o.hooks=r),R(n.headers)&&(s=q(s,n.headers),o.headers=s)}return void 0!==e&&(o.searchParams=e),i.length>0&&(1===i.length?o.signal=i[0]:o.signal=n?AbortSignal.any(i):i.at(-1)),o},v=t=>h.includes(t)?t.toUpperCase():t,A={limit:2,methods:["get","put","head","delete","options","trace"],statusCodes:[408,413,429,500,502,503,504],afterStatusCodes:[413,429,503],maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY,delay:t=>.3*2**(t-1)*1e3,jitter:void 0,retryOnTimeout:!1},C=(t={})=>{if("number"==typeof t)return{...A,limit:t};if(t.methods&&!Array.isArray(t.methods))throw new Error("retry.methods must be an array");if(t.methods&&=t.methods.map((t=>t.toLowerCase())),t.statusCodes&&!Array.isArray(t.statusCodes))throw new Error("retry.statusCodes must be an array");const e=Object.fromEntries(Object.entries(t).filter((([,t])=>void 0!==t)));return{...A,...e}};class O extends Error{request;constructor(t){super(`Request timed out: ${t.method} ${t.url}`),this.name="TimeoutError",this.request=t}}function N(t){return j(t)||U(t)||L(t)}function j(e){return e instanceof t||e?.name===t.name}function U(t){return t instanceof O||t?.name===O.name}function L(t){return t instanceof o||t?.name===o.name}class D{static create(e,s){const r=new D(e,s),n=r.#t((async()=>{if("number"==typeof r.#e.timeout&&r.#e.timeout>u)throw new RangeError("The `timeout` option cannot be greater than 2147483647");await Promise.resolve();let e=await r.#o();for(const t of r.#e.hooks.afterResponse){const s=r.#s(e.clone());let n;try{n=await t(r.request,r.#r(),s,{retryCount:r.#n})}catch(t){throw r.#i(s),r.#i(e),t}if(n instanceof f)throw r.#i(s),r.#i(e),new o(n.options);const i=n instanceof globalThis.Response?n:e;s!==i&&r.#i(s),e!==i&&r.#i(e),e=i}if(r.#s(e),!e.ok&&("function"==typeof r.#e.throwHttpErrors?r.#e.throwHttpErrors(e.status):r.#e.throwHttpErrors)){let o=new t(e,r.request,r.#r());for(const t of r.#e.hooks.beforeError)o=await t(o,{retryCount:r.#n});throw o}if(r.#e.onDownloadProgress){if("function"!=typeof r.#e.onDownloadProgress)throw new TypeError("The `onDownloadProgress` option must be a function");if(!i)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");const t=e.clone();return r.#i(e),((t,e)=>{if(!t.body)return t;if(204===t.status)return new Response(null,{status:t.status,statusText:t.statusText,headers:t.headers});const o=Math.max(0,Number(t.headers.get("content-length"))||0);return new Response(b(t.body,o,e),{status:t.status,statusText:t.statusText,headers:t.headers})})(t,r.#e.onDownloadProgress)}return e})).finally((()=>{const t=r.#a;r.#h(t?.body??void 0),r.#h(r.request.body??void 0)}));for(const[t,e]of Object.entries(c))"bytes"===t&&"function"!=typeof globalThis.Response?.prototype?.bytes||(n[t]=async()=>{r.request.headers.set("accept",r.request.headers.get("accept")||e);const o=await n;if("json"===t){if(204===o.status)return"";const t=await o.text();return""===t?"":s.parseJson?s.parseJson(t):JSON.parse(t)}return o[t]()});return n}static#c(t){return!t||"object"!=typeof t||Array.isArray(t)||t instanceof URLSearchParams?t:Object.fromEntries(Object.entries(t).filter((([,t])=>void 0!==t)))}request;#u;#n=0;#l;#e;#a;#p;#f;constructor(t,e={}){if(this.#l=t,this.#e={...e,headers:q(this.#l.headers,e.headers),hooks:x({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},e.hooks),method:v(e.method??this.#l.method??"GET"),prefixUrl:String(e.prefixUrl||""),retry:C(e.retry),throwHttpErrors:e.throwHttpErrors??!0,timeout:e.timeout??1e4,fetch:e.fetch??globalThis.fetch.bind(globalThis),context:e.context??{}},"string"!=typeof this.#l&&!(this.#l instanceof URL||this.#l instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this.#e.prefixUrl&&"string"==typeof this.#l){if(this.#l.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this.#e.prefixUrl.endsWith("/")||(this.#e.prefixUrl+="/"),this.#l=this.#e.prefixUrl+this.#l}r&&n&&(this.#p=this.#e.signal??this.#l.signal,this.#u=new globalThis.AbortController,this.#e.signal=this.#p?AbortSignal.any([this.#p,this.#u.signal]):this.#u.signal),s&&(this.#e.duplex="half"),void 0!==this.#e.json&&(this.#e.body=this.#e.stringifyJson?.(this.#e.json)??JSON.stringify(this.#e.json),this.#e.headers.set("content-type",this.#e.headers.get("content-type")??"application/json"));const o=e.headers&&new globalThis.Headers(e.headers).has("content-type");if(this.#l instanceof globalThis.Request&&(a&&this.#e.body instanceof globalThis.FormData||this.#e.body instanceof URLSearchParams)&&!o&&this.#e.headers.delete("content-type"),this.request=new globalThis.Request(this.#l,this.#e),void 0!==(i=this.#e.searchParams)&&(Array.isArray(i)?i.length>0:i instanceof URLSearchParams?i.size>0:"object"==typeof i?Object.keys(i).length>0:"string"==typeof i?i.trim().length>0:Boolean(i))){const t="?"+("string"==typeof this.#e.searchParams?this.#e.searchParams.replace(/^\?/,""):new URLSearchParams(D.#c(this.#e.searchParams)).toString()),e=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,t);this.request=new globalThis.Request(e,this.#e)}var i;if(this.#e.onUploadProgress){if("function"!=typeof this.#e.onUploadProgress)throw new TypeError("The `onUploadProgress` option must be a function");if(!s)throw new Error("Request streams are not supported in your environment. The `duplex` option for `Request` is not available.");this.request=this.#d(this.request,this.#e.body??void 0)}}#y(){const t=this.#e.retry.delay(this.#n);let e=t;!0===this.#e.retry.jitter?e=Math.random()*t:"function"==typeof this.#e.retry.jitter&&(e=this.#e.retry.jitter(t),(!Number.isFinite(e)||e<0)&&(e=t));const o=this.#e.retry.backoffLimit??Number.POSITIVE_INFINITY;return Math.min(o,e)}async#g(t){if(this.#n++,this.#n>this.#e.retry.limit)throw t;const s=t instanceof Error?t:new e(t);if(s instanceof o)return s.customDelay??this.#y();if(!this.#e.retry.methods.includes(this.request.method.toLowerCase()))throw t;if(void 0!==this.#e.retry.shouldRetry){const e=await this.#e.retry.shouldRetry({error:s,retryCount:this.#n});if(!1===e)throw t;if(!0===e)return this.#y()}if(U(t)&&!this.#e.retry.retryOnTimeout)throw t;if(j(t)){if(!this.#e.retry.statusCodes.includes(t.response.status))throw t;const e=t.response.headers.get("Retry-After")??t.response.headers.get("RateLimit-Reset")??t.response.headers.get("X-RateLimit-Retry-After")??t.response.headers.get("X-RateLimit-Reset")??t.response.headers.get("X-Rate-Limit-Reset");if(e&&this.#e.retry.afterStatusCodes.includes(t.response.status)){let t=1e3*Number(e);Number.isNaN(t)?t=Date.parse(e)-Date.now():t>=Date.parse("2024-01-01")&&(t-=Date.now());const o=this.#e.retry.maxRetryAfter??t;return t<o?t:o}if(413===t.response.status)throw t}return this.#y()}#s(t){return this.#e.parseJson&&(t.json=async()=>this.#e.parseJson(await t.text())),t}#h(t){t&&t.cancel().catch((()=>{}))}#i(t){this.#h(t.body??void 0)}async#t(t){try{return await t()}catch(e){const s=Math.min(await this.#g(e),u);if(this.#n<1)throw e;if(await async function(t,{signal:e}){return new Promise(((o,s)=>{function r(){clearTimeout(n),s(e.reason)}e&&(e.throwIfAborted(),e.addEventListener("abort",r,{once:!0}));const n=setTimeout((()=>{e?.removeEventListener("abort",r),o()}),t)}))}(s,this.#p?{signal:this.#p}:{}),e instanceof o&&e.customRequest){const t=this.#e.signal?new globalThis.Request(e.customRequest,{signal:this.#e.signal}):new globalThis.Request(e.customRequest);this.#m(t)}for(const t of this.#e.hooks.beforeRetry){const o=await t({request:this.request,options:this.#r(),error:e,retryCount:this.#n});if(o instanceof globalThis.Request){this.#m(o);break}if(o instanceof globalThis.Response)return o;if(o===p)return}return this.#t(t)}}async#o(){this.#u?.signal.aborted&&(this.#u=new globalThis.AbortController,this.#e.signal=this.#p?AbortSignal.any([this.#p,this.#u.signal]):this.#u.signal,this.request=new globalThis.Request(this.request,{signal:this.#e.signal}));for(const t of this.#e.hooks.beforeRequest){const e=await t(this.request,this.#r(),{retryCount:this.#n});if(e instanceof Response)return e;if(e instanceof globalThis.Request){this.#m(e);break}}const t=((t,e)=>{const o={};for(const s in e)Object.hasOwn(e,s)&&(s in m||s in y||s in t&&!(s in g)||(o[s]=e[s]));return o})(this.request,this.#e);return this.#a=this.request,this.request=this.#a.clone(),!1===this.#e.timeout?this.#e.fetch(this.#a,t):async function(t,e,o,s){return new Promise(((r,n)=>{const i=setTimeout((()=>{o&&o.abort(),n(new O(t))}),s.timeout);s.fetch(t,e).then(r).catch(n).then((()=>{clearTimeout(i)}))}))}(this.#a,t,this.#u,this.#e)}#r(){if(!this.#f){const{hooks:t,...e}=this.#e;this.#f=Object.freeze(e)}return this.#f}#m(t){this.#f=void 0,this.request=this.#d(t)}#d(t,e){return this.#e.onUploadProgress&&t.body?w(t,this.#e.onUploadProgress,e??this.#e.body??void 0):t}}
/*! MIT License Â© Sindre Sorhus */const B=t=>{const e=(e,o)=>D.create(e,T(t,o));for(const o of h)e[o]=(e,s)=>D.create(e,T(t,s,{method:o}));return e.create=t=>B(T(t)),e.extend=e=>("function"==typeof e&&(e=e(t??{})),B(T(t,e))),e.stop=p,e.retry=d,e},k=B();export{o as ForceRetryError,t as HTTPError,O as TimeoutError,k as default,L as isForceRetryError,j as isHTTPError,N as isKyError,U as isTimeoutError};
//# sourceMappingURL=/sm/ce3376efb589d130252f2418d61a5ecad8293435310d4003e0e3581f0eb173d7.map